"""
# Event Name

Squid tracks next on-chain events:
  * Posts.PostCreated
  * Posts.PostUpdated
  * Posts.PostMoved
  * Reactions.PostReactionCreated
  * Reactions.PostReactionUpdated
  * Reactions.PostReactionDeleted
  * Spaces.SpaceCreated
  * Spaces.SpaceUpdated
  * Profiles.ProfileUpdated
  * SpaceFollows.SpaceFollowed
  * SpaceFollows.SpaceUnfollowed
  * SpaceOwnership.SpaceOwnershipTransferAccepted
  * AccountFollows.AccountFollowed
  * AccountFollows.AccountUnfollowed

***

As some of on-chain events has multiple logical meanings,
squid uses synthetic events in addition to native on-chain events.

> **"Synthetic event"** - logical event which does not exist in blockchain and can be
> generated by blockchain event with specific data conditions.

### Full list of on-squid events is provided below:
* PostCreated
* PostDeleted - *synthetic*
* PostUpdated
* PostShared -  *synthetic*
* PostMoved
* PostFollowed - *synthetic*
* PostUnfollowed - *synthetic*
* PostReactionCreated
* PostReactionUpdated
* PostReactionDeleted
* SpaceCreated
* SpaceUpdated
* SpaceFollowed
* SpaceUnfollowed
* SpaceOwnershipTransferAccepted
* AccountFollowed
* AccountUnfollowed
* ProfileUpdated
* CommentCreated - *synthetic*
* CommentDeleted - *synthetic*
* CommentUpdated - *synthetic*
* CommentShared - *synthetic*
* CommentReactionCreated - *synthetic*
* CommentReactionUpdated - *synthetic*
* CommentReactionDeleted - *synthetic*
* CommentReplyCreated - *synthetic*
* CommentReplyDeleted - *synthetic*
* CommentReplyUpdated - *synthetic*
* CommentReplyShared - *synthetic*
* CommentReplyReactionCreated - *synthetic*
* CommentReplyReactionUpdated - *synthetic*
* CommentReplyReactionDeleted - *synthetic*
"""
enum EventName {
  PostCreated
  PostDeleted # synthetic
  PostUpdated
  PostShared # synthetic
  PostMoved
  PostFollowed # synthetic
  PostUnfollowed # synthetic
  PostReactionCreated
  PostReactionUpdated
  PostReactionDeleted

  SpaceCreated
  SpaceUpdated
  SpaceFollowed
  SpaceUnfollowed
  SpaceOwnershipTransferAccepted

  AccountFollowed
  AccountUnfollowed
  ProfileUpdated

  CommentCreated # synthetic
  CommentDeleted # synthetic
  CommentUpdated # synthetic
  CommentShared # synthetic
  CommentReactionCreated # synthetic
  CommentReactionUpdated # synthetic
  CommentReactionDeleted # synthetic
  CommentReplyCreated # synthetic
  CommentReplyDeleted # synthetic
  CommentReplyUpdated # synthetic
  CommentReplyShared # synthetic
  CommentReplyReactionCreated # synthetic
  CommentReplyReactionUpdated # synthetic
  CommentReplyReactionDeleted # synthetic
}

"""
Post kind.
  - Comment - Post is a Comment or Comment Reply
  - SharedPost - Post has been created as sharing of another Post
  - RegularPost - Regular top level post
"""
enum PostKind {
  Comment
  SharedPost
  RegularPost
}
enum ReactionKind {
  Upvote
  Downvote
}

enum Status {
  Active
  Deleted
}

"""
Account entity
"""
type Account @entity {
  """
  Account public key converted to ss58 format for Subsocial chain (prefix "28")
  """
  id: ID!

  """
  One-To-One relationship with Space entity which is defined as Account Profile
  """
  profileSpace: Space

  """
  Many-To-Many relationship between current Account and follower Account through AccountFollowers (foreign key - "followingAccount")
  """
  followers: [AccountFollowers]! @derivedFrom(field: "followingAccount")

  """
  Total number of all Account followers (followers.length)
  """
  followersCount: Int!

  """
  Many-To-Many relationship between current Account and following Account through AccountFollowers (foreign key - "followerAccount")
  """
  followingAccounts: [AccountFollowers]! @derivedFrom(field: "followerAccount")

  """
  Total number of all following accounts by current Account (followingAccounts.length)
  """
  followingAccountsCount: Int!

  """
  One-To-Many relationship with Posts which are created by Account (foreign key - "createdByAccount")
  """
  posts: [Post] @derivedFrom(field: "createdByAccount")

  """
  One-To-Many relationship with Posts which are owned by Account (foreign key - "ownedByAccount")
  """
  ownedPosts: [Post] @derivedFrom(field: "ownedByAccount")

  """
  Total number of all owned by Account Posts (ownedPosts.length)
  """
  ownedPostsCount: Int!

  """
  Total number of all Posts which Account is following (currently only post creator is it's follower)
  """
  followingPostsCount: Int!

  """
  One-To-Many relationship with Spaces which are created by Account (foreign key - "createdByAccount")
  """
  spacesCreated: [Space!] @derivedFrom(field: "createdByAccount")

  """
  One-To-Many relationship with Spaces which are owned by Account (foreign key - "ownedByAccount")
  """
  spacesOwned: [Space!] @derivedFrom(field: "ownedByAccount")

  """
  Many-To-Many relationship between Account and followed Spaces through SpaceFollowers (foreign key - "followerAccount")
  """
  spacesFollowed: [SpaceFollowers!] @derivedFrom(field: "followerAccount")

  """
  Total number of all Spaces which Account is following
  """
  followingSpacesCount: Int!

  """
  Many-To-Many relationship between Account and done Activity in network through NewsFeed (foreign key - "account").
  Each Activity has "event<EventName>" and "post" fields which can be used for adding created Posts to user's Feed.
  """
  feeds: [NewsFeed]! @derivedFrom(field: "account")

  """
  Many-To-Many relationship between Account and done Activity in network through Notification (foreign key - "account").
  """
  notifications: [Notification]! @derivedFrom(field: "account")

  """
  One-To-Many relationship with Activity which are done by Account (foreign key - "account")
  """
  activities: [Activity]! @derivedFrom(field: "account")

  """
  One-To-Many relationship with Reaction which are done by Account (foreign key - "account")
  """
  reactions: [Reaction]! @derivedFrom(field: "account")

  """
  DateTime when Account has been updated by Profiles.ProfileUpdated event
  """
  updatedAtTime: DateTime

  """
  Block height when Account has been updated by Profiles.ProfileUpdated event
  """
  updatedAtBlock: BigInt
}

"""
Post entity
"""
type Post @entity {
  """
  Post ID. The same as in blockchain.
  """
  id: ID!

  """
  One-to-One relationship with Post. This field has value only if current Post is a Comment or Reply to Comment and contains relation with top level Regular Post.
  """
  rootPost: Post

  """
  One-to-One relationship with Post. This field has value only if current Post is a Reply to Comment and contains relation with Comment Post or another Reply (in case there is discussion within context of some Comment).
  """
  parentPost: Post

  """
  One-to-One relationship with Post which has been shared. Current Post is a new Post which has been created during sharing action and can contain additional body as a comment to sharing Post. "sharedPost" is relation with Post which has been shared
  """
  sharedPost: Post

  """
  Is current Post a Comment to Regular Post or Comment Post
  """
  isComment: Boolean! @index

  """
  Is current post hidden
  """
  hidden: Boolean! @index

  """
  One-To-One relationship with Post's owner Account entity. Currently we don't have Post transfer functionality.
  """
  ownedByAccount: Account!

  """
  One-To-One relationship with Post's creator Account entity
  """
  createdByAccount: Account!

  """
  Block height when Post has been created
  """
  createdAtBlock: BigInt

  """
  DateTime when Post has been created
  """
  createdAtTime: DateTime @index

  """
  Day when Post has been created
  """
  createdOnDay: DateTime

  """
  Time when Post has been created
  """
  updatedAtTime: DateTime

  """
  One-To-One relationship with Space current Post has been created on. Can be null in case Post is deleted (moved to Space with ID === null)
  """
  space: Space

  """
  Type of the Post (Comment | SharedPost | RegularPost)
  """
  kind: PostKind @index

  """
  One-To-Many relationship with Regular Post's followers (foreign key - "followingPost") (currently only Post's creator can be follower of the Post)
  """
  postFollowers: [PostFollowers] @derivedFrom(field: "followingPost")

  """
  One-To-Many relationship with Comment Post's or Comment Replies followers (foreign key - "followingPost") (currently only Post's creator can be follower of the Post)
  """
  commentFollowers: [CommentFollowers] @derivedFrom(field: "followingComment")

  """
  Total number of all Post followers
  """
  followersCount: Int! @index

  """
  Total number of replies to current Post
  """
  repliesCount: Int!

  """
  Total number of non-hidden replies to current Post
  """
  publicRepliesCount: Int! @index

  """
  Total number of hidden replies to current Post
  """
  hiddenRepliesCount: Int!

  """
  How many times current Post has been shared
  """
  sharesCount: Int! @index

  """
  Total number of UpVote reaction for current Post
  """
  upvotesCount: Int! @index

  """
  Total number of DownVote reaction for current Post
  """
  downvotesCount: Int! @index

  """
  Total number of all reaction for current Post
  """
  reactionsCount: Int! @index

  """
  One-To-Many relationship with Reactions for this current Post (foreign key - "post")
  """
  reactions: [Reaction] @derivedFrom(field: "post")

  """
  Post title (IPFS content)
  """
  title: String
  """
  Post image URL (IPFS content)
  """
  image: String
  """
  Post link (IPFS content)
  """
  link: String
  """
  Post canonical URL (IPFS content)
  """
  canonical: String
  """
  IPFS content CID
  """
  content: String
  """
  Post slug URL (IPFS content)
  """
  slug: String
  """
  Post body (IPFS content)
  """
  body: String
  """
  Post body summary (IPFS content)
  """
  summary: String
  """
  If body is longer than summary, field contains true.
  """
  isShowMore: Boolean
  """
  ! Deprecated field and will be removed !
  """
  meta: String
  """
  List of Post's tags converted to string with "comma" as a separator (IPFS content)
  """
  tagsOriginal: String
  """
  Post format (IPFS content)
  """
  format: String
  """
  Tweet ID attached to current Post (IPFS content)
  """
  tweetId: String
  """
  Tweet details (IPFS content)
  """
  tweetDetails: TweetDetails
  """
  ! Deprecated field and will be removed !
  """
  proposalIndex: Int # postContent.meta[0]
}

"""
Post Reaction entity
"""
type Reaction @entity {
  """
  Reaction ID. Has the same value and reaction ID in blockchain.
  """
  id: ID!

  """
  One-to-One relationship with Post current reaction has been made for.
  """
  post: Post!

  """
  One-to-One relationship with Reaction creator Account.
  """
  account: Account!

  """
  Reaction kind (Upvote, Downvote)
  """
  kind: ReactionKind! @index

  """
  Reaction status (Active, Deleted). Synthetic value, is not existing in blockchain and used only in squid.
  """
  status: Status! @index

  """
  Block height when Reaction has been created
  """
  createdAtBlock: BigInt!

  """
  DateTime when Reaction has been created
  """
  createdAtTime: DateTime!

  """
  Block height when Reaction has been updated
  """
  updatedAtBlock: BigInt

  """
  DateTime when Reaction has been updated
  """
  updatedAtTime: DateTime
}

type Space @entity {
  """
  Space ID. Has the same value and Space ID in blockchain.
  """
  id: ID!

  """
  One-To-One relationship with Space's creator Account entity
  """
  createdByAccount: Account!

  """
  One-To-One relationship with Space's owner Account entity
  """
  ownedByAccount: Account!

  """
  One-To-One relationship with Account which uses current Space as it's profile
  """
  profileSpace: Account

  """
  Block height when Space has been created
  """
  createdAtBlock: BigInt

  """
  DateTime height when Post has been created
  """
  createdAtTime: DateTime @index

  """
  Day when Post has been created
  """
  createdOnDay: DateTime

  """
  DateTime when Post has been created
  """
  updatedAtTime: DateTime

  """
  Block height when Space has been updated
  """
  updatedAtBlock: BigInt

  """
  One-To-Many relationship with Posts which are created within current Space (foreign key - "space")
  """
  posts: [Post]! @derivedFrom(field: "space")

  """
  Total number of all Posts (hidden and public) in current Space (post.length)
  """
  postsCount: Int!

  """
  Total number of non-hidden Posts in current Space (post.length)
  """
  publicPostsCount: Int! @index

  """
  Total number of hidden Posts in current Space (post.length)
  """
  hiddenPostsCount: Int!

  """
  Is Space hidden.
  """
  hidden: Boolean! @index

  """
  IPFS content CID
  """
  content: String
  """
  Name of Space (IPFS content)
  """
  name: String
  """
  URL of the image of Space (IPFS content)
  """
  image: String
  """
  About test of Space (IPFS content)
  """
  about: String
  """
  Summary from content of Space (IPFS content)
  """
  summary: String
  """
  If "about" is longer than summary, field contains true.
  """
  isShowMore: Boolean

  """
  Email of Space (IPFS content)
  """
  email: String

  """
  List of Space's tags converted to string with "comma" as a separator (IPFS content)
  """
  tagsOriginal: String

  """
  List of Space's links converted to string with "comma" as a separator (IPFS content)
  """
  linksOriginal: String

  """
  List of Space's interests converted to string with "comma" as a separator (IPFS content)
  """
  interestsOriginal: String

  """
  Space format (IPFS content)
  """
  format: String

  """
  Space handle (will be renamed to domain or username) (IPFS content)
  """
  handle: String

  """
  Space permissions rule
  """
  canFollowerCreatePosts: Boolean

  """
  Space permissions rule
  """
  canEveryoneCreatePosts: Boolean

  """
  Space permissions rule
  """
  nonePermissions: SpacePermissions
  """
  Space permissions rule
  """
  everyonePermissions: SpacePermissions
  """
  Space permissions rule
  """
  followerPermissions: SpacePermissions
  """
  Space permissions rule
  """
  spaceOwnerPermissions: SpacePermissions

  """
  Many-To-Many relationship between Space and follower Account through SpaceFollowers (foreign key - "followingSpace")
  """
  followers: [SpaceFollowers]! @derivedFrom(field: "followingSpace")

  """
  Total number of all followers
  """
  followersCount: Int! @index
}

"""
Activity entity - represents any activity in blockchain (within tracked events list).
"""
type Activity @entity {
  """
  Activity ID. Has next structure - <blockNumber>-<indexInBlock>-<md5Hash(eventName)>` (e.g. 1093209-1001-1ee8fd8482c322254acff29a8f52f5e1)
  """
  id: ID!

  """
  One-To-One relationship with Account who initiated current activity (usually it's a caller Account)
  """
  account: Account!

  """
  Block height when activity has been done
  """
  blockNumber: BigInt!

  """
  Event's index in block
  """
  eventIndex: Int!

  """
  Event name
  """
  event: EventName! @index

  """
  One-to-One relationship with following Account if event is ***Followed or ***Unfollowed.
  Following account|post|space will be saved in appropriate field.
  """
  followingAccount: Account

  """
  One-to-One relationship with Space which has been involved to current Activity
  """
  space: Space
  """
  One-to-One relationship with previous Space if event is "PostMoved"
  """
  spacePrev: Space

  """
  One-to-One relationship with previous owner Account if event is "SpaceOwnershipTransferAccepted"
  """
  newOwner: Account

  """
  One-to-One relationship with new owner Account if event is "SpaceOwnershipTransferAccepted"
  """
  oldOwner: Account

  """
  One-to-One relationship with Post which has been involved to current Activity
  """
  post: Post

  """
  One-to-One relationship with Reaction which has been involved to current Activity
  """
  reaction: Reaction

  """
  DateTime when current activity has been done
  """
  date: DateTime!

  """
  If false, so this Activity is not latest with the same event type for specific Account.
  """
  aggregated: Boolean @index

  """
  Total number of Activities with the same event type for specific Account.
  """
  aggCount: BigInt!
}

"""
Join table for Many-to-Many relationship between follower and following Accounts
"""
type AccountFollowers @entity {
  followerAccount: Account!
  followingAccount: Account!
}

"""
Join table for Many-to-Many relationship between follower Account and following Space
"""
type SpaceFollowers @entity {
  followerAccount: Account!
  followingSpace: Space!
}

"""
Join table for Many-to-Many relationship between follower Account and following Post
"""
type PostFollowers @entity {
  followerAccount: Account!
  followingPost: Post!
}

"""
Join table for Many-to-Many relationship between follower Account and following Comment
"""
type CommentFollowers @entity {
  followerAccount: Account!
  followingComment: Post!
}

"""
Join table for Many-to-Many relationship between Account and Activity
"""
type NewsFeed @entity {
  account: Account!
  activity: Activity!
}

"""
Join table for Many-to-Many relationship between Account and Notification
"""
type Notification @entity {
  account: Account!
  activity: Activity!
}

"""
Space permissions
"""
type SpacePermissions {
  manageRoles: Boolean
  representSpaceInternally: Boolean
  representSpaceExternally: Boolean
  updateSpace: Boolean
  createSubspaces: Boolean
  updateOwnSubspaces: Boolean
  deleteOwnSubspaces: Boolean
  hideOwnSubspaces: Boolean
  updateAnySubspace: Boolean
  deleteAnySubspace: Boolean
  hideAnySubspace: Boolean
  createPosts: Boolean
  updateOwnPosts: Boolean
  deleteOwnPosts: Boolean
  hideOwnPosts: Boolean
  updateAnyPost: Boolean
  deleteAnyPost: Boolean
  hideAnyPost: Boolean
  createComments: Boolean
  updateOwnComments: Boolean
  deleteOwnComments: Boolean
  hideOwnComments: Boolean
  hideAnyComment: Boolean
  upvote: Boolean
  downvote: Boolean
  share: Boolean
  overrideSubspacePermissions: Boolean
  overridePostPermissions: Boolean
  suggestEntityStatus: Boolean
  updateEntityStatus: Boolean
  updateSpaceSettings: Boolean
}

"""
Detailed information for Tweet attached to Post
"""
type TweetDetails {
  createdAt: String
  username: String
  authorId: String
  editHistoryTweetIds: [String]
  conversationId: String
  inReplyToUserId: String
  referencedTweets: [ReferencedTweetDetails]
  attachments: TweetAttachmentsDetails
  lang: String
}

type ReferencedTweetDetails {
  id: String
  type: String
}

type TweetAttachmentsDetails {
  mediaKeys: [String]
  pollIds: [String]
}

type IpfsFetchLog @entity {
  id: ID!
  cid: String
  blockHeight: Int!
  errorMsg: String
}
